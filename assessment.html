<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Questionário de Maturidade em Gestão - Stratica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .hero-gradient {
            background: #f8f9fa;
        }
        /* Estilo para radio buttons customizados */
        .radio-custom {
            appearance: none;
            -webkit-appearance: none;
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid #d1d5db;
            border-radius: 50%;
            outline: none;
            transition: 0.2s all linear;
            margin-right: 0.5rem;
            position: relative;
            top: 4px;
        }
        .radio-custom:checked {
            border-color: #b91c1c; /* red-700 */
        }
        .radio-custom:checked::before {
            content: '';
            display: block;
            width: 0.75rem;
            height: 0.75rem;
            margin: 2px;
            background-color: #b91c1c; /* red-700 */
            border-radius: 50%;
        }
        .question-card {
            transition: all 0.3s ease-in-out;
        }
        .result-bar-fill {
            transition: width 1s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Cabeçalho e Navegação -->
    <header class="bg-white text-gray-800 sticky top-0 z-50 shadow-md">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="index.html" class="flex items-center">
                <img src="Logo09.avif" alt="Stratica Logo" class="h-10">
            </a>
            <nav class="hidden md:flex space-x-8">
                 <a href="index.html" class="bg-red-700 text-white px-4 py-2 rounded-md hover:bg-red-800 transition duration-300">Voltar ao Início</a>
            </nav>
            <button id="mobile-menu-button" class="md:hidden focus:outline-none">
                <i data-lucide="menu" class="w-6 h-6 text-gray-800"></i>
            </button>
        </div>
    </header>

    <main>
        <!-- Seção Hero -->
        <section id="home" class="relative text-gray-800 hero-gradient">
             <div class="container mx-auto px-6 py-20 md:py-32 text-center">
                <h1 class="text-4xl md:text-5xl font-extrabold leading-tight mb-4 text-red-700">Avaliação de Maturidade em Gestão</h1>
                <p class="text-lg md:text-xl text-gray-700 max-w-3xl mx-auto mb-8">Responda ao questionário abaixo para medir o nível de maturidade da gestão de sua empresa em 8 critérios de excelência e receba um diagnóstico instantâneo e acionável com pontuação de 0 a 1000 pontos.</p>
            </div>
        </section>

        <!-- Seção do Questionário -->
        <section id="questionario" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <form id="maturity-quiz-form">
                    <!-- As perguntas serão injetadas aqui pelo JavaScript -->
                    <div id="quiz-container" class="space-y-12"></div>

                    <!-- Seção de Coleta de Dados do Usuário -->
                    <div id="user-info" class="mt-16 pt-12 border-t border-gray-200">
                         <h2 class="text-3xl font-bold text-center mb-2 text-gray-800">Estamos quase lá!</h2>
                         <p class="text-center text-gray-600 mb-8">Preencha seus dados para ver seu resultado e receber uma análise detalhada.</p>
                         <div class="max-w-2xl mx-auto bg-gray-50 p-8 rounded-lg shadow-md">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Nome Completo</label>
                                    <input type="text" id="name" name="name" class="w-full p-3 rounded-md bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                                </div>
                                <div>
                                    <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email Corporativo</label>
                                    <input type="email" id="email" name="email" class="w-full p-3 rounded-md bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                                </div>
                                <div>
                                    <label for="company" class="block text-sm font-medium text-gray-700 mb-1">Empresa</label>
                                    <input type="text" id="company" name="company" class="w-full p-3 rounded-md bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                                </div>
                                 <div>
                                    <label for="position" class="block text-sm font-medium text-gray-700 mb-1">Cargo</label>
                                    <input type="text" id="position" name="position" class="w-full p-3 rounded-md bg-white border border-gray-300 focus:outline-none focus:ring-2 focus:ring-red-500" required>
                                </div>
                            </div>
                             <div class="mt-8 text-center">
                                <button type="submit" class="bg-red-700 hover:bg-red-800 text-white font-bold py-3 px-8 rounded-full text-lg transition duration-300 transform hover:scale-105">
                                    Calcular minha Maturidade
                                </button>
                            </div>
                         </div>
                    </div>
                </form>
            </div>
        </section>

        <!-- Seção de Resultado (inicialmente oculta) -->
        <section id="resultado" class="hidden py-20 bg-gray-800 text-white">
            <div class="container mx-auto px-6 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-4">Seu Diagnóstico de Maturidade</h2>
                <div class="max-w-3xl mx-auto bg-white text-gray-800 rounded-lg shadow-2xl p-8 md:p-12 mt-8">
                    <p class="text-lg mb-2">Sua pontuação de maturidade é:</p>
                    <p id="percentage-result" class="text-6xl font-extrabold text-red-700 mb-4">0%</p>
                    
                    <div class="w-full bg-gray-200 rounded-full h-6 mb-4 overflow-hidden">
                        <div id="result-bar" class="bg-red-700 h-6 rounded-full result-bar-fill" style="width: 0%"></div>
                    </div>

                    <h3 id="level-title" class="text-3xl font-bold mt-8 mb-3">Nível</h3>
                    <p id="level-description" class="text-lg text-gray-600">Descrição do nível de maturidade.</p>

                    <div class="mt-10 text-center">
                         <p class="text-gray-700">Um relatório detalhado com recomendações foi enviado para o seu e-mail.</p>
                         <button onclick="window.location.reload()" class="mt-6 bg-red-700 hover:bg-red-800 text-white font-bold py-3 px-6 rounded-full text-md transition duration-300">
                            Refazer Questionário
                        </button>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Rodapé -->
    <footer class="bg-gray-900 text-white">
        <div class="container mx-auto px-6 py-8 text-center">
            <p>&copy; 2025 Stratica. Todos os direitos reservados.</p>
            <p class="text-sm text-gray-400 mt-2">Consultoria Estratégica Powered by AI</p>
        </div>
    </footer>

    <script>
        // Funções globais para os botões (movidas para fora do DOMContentLoaded)
        
        // Função para contatar a Stratica diretamente
        function contactStratica() {
            const assessmentData = JSON.parse(localStorage.getItem('stratica_assessment_result') || '{}');
            const subject = `Solicitação de Análise - Assessment Nível ${assessmentData.result?.level || 'N/A'}`;
            const body = `Olá equipe Stratica,

Acabei de completar o Assessment de Maturidade Estratégica no site e gostaria de agendar uma conversa para discutir os resultados.

DADOS DO ASSESSMENT:
Empresa: ${assessmentData.userInfo?.company || 'N/A'}
Nome: ${assessmentData.userInfo?.name || 'N/A'}
Email: ${assessmentData.userInfo?.email || 'N/A'}
Cargo: ${assessmentData.userInfo?.position || 'Não informado'}

RESULTADO:
Nível: ${assessmentData.result?.level || 'N/A'} - ${assessmentData.result?.title || 'N/A'}
Pontuação: ${Math.round(assessmentData.percentage || 0)}%

Gostaria de entender melhor como a Stratica pode ajudar nossa empresa a evoluir para o próximo nível de maturidade estratégica.

Aguardo contato.

Atenciosamente,
${assessmentData.userInfo?.name || 'N/A'}`;

            const mailtoLink = `mailto:stratica@stratica.com.br?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(mailtoLink);
        }

        // Função para analisar pontuação por dimensão
        function analyzeDimensionScores(answers) {
            const dimensions = {
                'Liderança': ['q1', 'q2', 'q3'],
                'Estratégia': ['q4', 'q5', 'q6'],
                'Processos': ['q7', 'q8', 'q9'],
                'Pessoas': ['q10', 'q11', 'q12'],
                'Clientes': ['q13', 'q14', 'q15'],
                'Sociedade': ['q16', 'q17', 'q18'],
                'Informações e Conhecimento': ['q19', 'q20', 'q21'],
                'Resultados': ['q22', 'q23', 'q24', 'q25']
            };

            const analysis = {};
            
            Object.keys(dimensions).forEach(dimension => {
                const questionIds = dimensions[dimension];
                let totalScore = 0;
                let count = 0;
                
                questionIds.forEach(qId => {
                    if (answers[qId]) {
                        totalScore += answers[qId].score;
                        count++;
                    }
                });
                
                const avgScore = count > 0 ? totalScore / count : 0;
                const percentage = (avgScore / 5) * 100;
                
                // Calcular pontuação Stratica para esta dimensão
                const straticaScore = Math.round((percentage / 100) * 1000);
                
                analysis[dimension] = {
                    avgScore: avgScore,
                    percentage: percentage,
                    level: getResultDetailsStratica(straticaScore),
                    questions: questionIds.map(qId => answers[qId]).filter(Boolean)
                };
            });
            
            return analysis;
        }

        // Função getMaturityLevel removida - agora usamos apenas getResultDetailsStratica

        // Função para gerar recomendações específicas por dimensão
        function getDimensionRecommendations(dimension, analysis) {
            const recommendations = {
                'Liderança': {
                    1: [
                        "• Definir missão, visão e valores organizacionais claros",
                        "• Estabelecer programa de desenvolvimento de liderança",
                        "• Criar canais de comunicação estruturados",
                        "• Implementar reuniões regulares de alinhamento estratégico"
                    ],
                    2: [
                        "• Formalizar processos de comunicação da visão e valores",
                        "• Treinar líderes em técnicas de engajamento",
                        "• Estabelecer métricas de clima organizacional",
                        "• Criar programa de mentoring interno"
                    ],
                    3: [
                        "• Implementar avaliação 360° para líderes",
                        "• Desenvolver planos de sucessão",
                        "• Fortalecer cultura de feedback contínuo",
                        "• Integrar valores organizacionais aos processos de RH"
                    ],
                    4: [
                        "• Implementar liderança transformacional",
                        "• Desenvolver líderes como agentes de mudança",
                        "• Criar programas de inovação liderados pela alta gestão",
                        "• Estabelecer governança de sustentabilidade"
                    ],
                    5: [
                        "• Manter excelência e ser referência em liderança",
                        "• Compartilhar melhores práticas no mercado",
                        "• Desenvolver ecossistema de liderança colaborativa",
                        "• Liderar transformações setoriais"
                    ]
                },
                'Estratégia': {
                    1: [
                        "• Estabelecer processo básico de planejamento estratégico",
                        "• Definir objetivos SMART de curto e médio prazo",
                        "• Implementar análise SWOT estruturada",
                        "• Criar comitê de estratégia"
                    ],
                    2: [
                        "• Formalizar ciclo anual de planejamento estratégico",
                        "• Implementar análise de cenários",
                        "• Estabelecer indicadores estratégicos básicos",
                        "• Criar processo de comunicação da estratégia"
                    ],
                    3: [
                        "• Implementar balanced scorecard ou similar",
                        "• Desenvolver capacidade de inteligência competitiva",
                        "• Estabelecer processo de revisão trimestral",
                        "• Integrar planejamento estratégico ao orçamento"
                    ],
                    4: [
                        "• Implementar gestão de portfólio estratégico",
                        "• Desenvolver capacidades de inovação estratégica",
                        "• Fortalecer análise de riscos estratégicos",
                        "• Integrar sustentabilidade à estratégia"
                    ],
                    5: [
                        "• Manter excelência em gestão estratégica",
                        "• Desenvolver estratégias disruptivas",
                        "• Liderar ecossistemas de inovação",
                        "• Ser referência em agilidade estratégica"
                    ]
                },
                'Processos': {
                    1: [
                        "• Mapear processos críticos do negócio",
                        "• Estabelecer padrões básicos de qualidade",
                        "• Implementar controles essenciais",
                        "• Treinar equipes em processos básicos"
                    ],
                    2: [
                        "• Documentar todos os processos principais",
                        "• Implementar indicadores básicos de processo",
                        "• Estabelecer rotinas de monitoramento",
                        "• Criar programa de melhoria de processos"
                    ],
                    3: [
                        "• Implementar gestão por processos (BPM)",
                        "• Estabelecer SLAs para processos críticos",
                        "• Desenvolver cultura de melhoria contínua",
                        "• Integrar processos entre áreas"
                    ],
                    4: [
                        "• Implementar automação de processos (RPA)",
                        "• Desenvolver processos ágeis e adaptativos",
                        "• Estabelecer centro de excelência em processos",
                        "• Integrar IA em processos críticos"
                    ],
                    5: [
                        "• Manter excelência operacional",
                        "• Liderar inovação em processos",
                        "• Desenvolver processos inteligentes",
                        "• Ser referência em eficiência operacional"
                    ]
                },
                'Pessoas': {
                    1: [
                        "• Estabelecer programa básico de treinamento",
                        "• Implementar processo de avaliação de desempenho",
                        "• Criar descrições de cargo estruturadas",
                        "• Desenvolver política de remuneração justa"
                    ],
                    2: [
                        "• Implementar plano de desenvolvimento individual",
                        "• Estabelecer programa de feedback regular",
                        "• Criar trilhas de carreira",
                        "• Desenvolver programa de reconhecimento"
                    ],
                    3: [
                        "• Implementar gestão de talentos estruturada",
                        "• Desenvolver programa de liderança interna",
                        "• Estabelecer pesquisa de clima organizacional",
                        "• Criar programa de diversidade e inclusão"
                    ],
                    4: [
                        "• Implementar gestão de conhecimento",
                        "• Desenvolver cultura de aprendizagem contínua",
                        "• Estabelecer programa de inovação colaborativa",
                        "• Criar ambiente de trabalho ágil e flexível"
                    ],
                    5: [
                        "• Manter excelência em gestão de pessoas",
                        "• Ser referência em employer branding",
                        "• Liderar transformação do futuro do trabalho",
                        "• Desenvolver ecossistema de talentos"
                    ]
                },
                'Clientes': {
                    1: [
                        "• Implementar pesquisa básica de satisfação",
                        "• Estabelecer canais de atendimento estruturados",
                        "• Criar processo de tratamento de reclamações",
                        "• Treinar equipes em atendimento ao cliente"
                    ],
                    2: [
                        "• Implementar programa de NPS",
                        "• Estabelecer jornada do cliente básica",
                        "• Criar programa de fidelização",
                        "• Desenvolver segmentação de clientes"
                    ],
                    3: [
                        "• Implementar CRM estruturado",
                        "• Desenvolver experiência do cliente omnichannel",
                        "• Estabelecer programa de customer success",
                        "• Criar métricas avançadas de relacionamento"
                    ],
                    4: [
                        "• Implementar personalização em escala",
                        "• Desenvolver programa de co-criação",
                        "• Estabelecer comunidade de clientes",
                        "• Integrar IA na experiência do cliente"
                    ],
                    5: [
                        "• Manter excelência em experiência do cliente",
                        "• Ser referência em customer centricity",
                        "• Liderar inovação em relacionamento",
                        "• Desenvolver ecossistema de valor para clientes"
                    ]
                },
                'Resultados': {
                    1: [
                        "• Implementar dashboard básico de indicadores",
                        "• Estabelecer metas financeiras claras",
                        "• Criar rotina de acompanhamento mensal",
                        "• Treinar gestores em análise de resultados"
                    ],
                    2: [
                        "• Implementar balanced scorecard",
                        "• Estabelecer benchmarking básico",
                        "• Criar processo de análise de desvios",
                        "• Desenvolver cultura orientada a resultados"
                    ],
                    3: [
                        "• Implementar business intelligence",
                        "• Estabelecer análise preditiva básica",
                        "• Criar centro de competência em analytics",
                        "• Integrar indicadores financeiros e não-financeiros"
                    ],
                    4: [
                        "• Implementar analytics avançado",
                        "• Desenvolver modelos preditivos",
                        "• Estabelecer gestão de valor integrada",
                        "• Criar cultura data-driven"
                    ],
                    5: [
                        "• Manter excelência em gestão de resultados",
                        "• Ser referência em analytics e BI",
                        "• Liderar inovação em métricas de valor",
                        "• Desenvolver ecossistema de dados inteligentes"
                    ]
                }
            };

            const level = analysis.level.level;
            return recommendations[dimension]?.[level] || recommendations[dimension]?.[1] || [];
        }

        // Função para baixar relatório melhorado
        function downloadReport() {
            const assessmentData = JSON.parse(localStorage.getItem('stratica_assessment_result') || '{}');
            const dimensionAnalysis = analyzeDimensionScores(assessmentData.answers || {});
            
            // Criar conteúdo do relatório detalhado
            let reportContent = `
RELATÓRIO DETALHADO DE MATURIDADE ESTRATÉGICA
Stratica Consultoria - Powered by AI

═══════════════════════════════════════════════════════════════

PARTICIPANTE:
Nome: ${assessmentData.userInfo?.name || 'N/A'}
Email: ${assessmentData.userInfo?.email || 'N/A'}
Empresa: ${assessmentData.userInfo?.company || 'N/A'}
Cargo: ${assessmentData.userInfo?.position || 'Não informado'}

═══════════════════════════════════════════════════════════════

RESULTADO GERAL:
Nível de Maturidade: ${assessmentData.result?.level || 'N/A'} - ${assessmentData.result?.title || 'N/A'}
Pontuação Geral: ${Math.round(assessmentData.percentage || 0)}%

DESCRIÇÃO:
${assessmentData.result?.description || 'N/A'}

═══════════════════════════════════════════════════════════════

ANÁLISE DETALHADA POR DIMENSÃO:

`;

            // Adicionar análise de cada dimensão
            Object.keys(dimensionAnalysis).forEach(dimension => {
                const analysis = dimensionAnalysis[dimension];
                const recommendations = getDimensionRecommendations(dimension, analysis);
                
                reportContent += `
📊 ${dimension.toUpperCase()}
Pontuação: ${Math.round(analysis.percentage)}% (Nível ${analysis.level.level} - ${analysis.level.title})

SITUAÇÃO ATUAL:
`;
                analysis.questions.forEach((q, index) => {
                    reportContent += `${index + 1}. ${q.question}\n   Resposta: ${q.answer_text} (${q.score}/5)\n\n`;
                });

                reportContent += `
RECOMENDAÇÕES ESTRATÉGICAS:
${recommendations.join('\n')}

───────────────────────────────────────────────────────────────

`;
            });

            reportContent += `
═══════════════════════════════════════════════════════════════

PRÓXIMOS PASSOS RECOMENDADOS:

1. PRIORIZAÇÃO: Foque nas dimensões com menor pontuação primeiro
2. PLANEJAMENTO: Desenvolva um plano de ação com prazos definidos
3. IMPLEMENTAÇÃO: Execute as recomendações de forma gradual
4. MONITORAMENTO: Acompanhe o progresso mensalmente
5. REAVALIAÇÃO: Refaça o assessment em 6-12 meses

═══════════════════════════════════════════════════════════════

COMO A STRATICA PODE AJUDAR:

✓ Consultoria estratégica personalizada
✓ Implementação de metodologias comprovadas
✓ Treinamento e capacitação de equipes
✓ Acompanhamento e mentoring executivo
✓ Soluções de IA e transformação digital

Entre em contato: stratica@stratica.com.br
Website: www.stratica.com.br

Data do Assessment: ${new Date(assessmentData.timestamp || Date.now()).toLocaleString('pt-BR')}

---
Relatório gerado por Stratica Consultoria
Consultoria Estratégica Powered by AI
            `.trim();

            // Criar e baixar arquivo
            const blob = new Blob([reportContent], { type: 'text/plain;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Relatorio_Detalhado_Maturidade_${assessmentData.userInfo?.company?.replace(/\s+/g, '_') || 'Assessment'}_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Função para obter recomendações baseadas no nível (mantida para compatibilidade)
        function getRecommendations(level) {
            const recommendations = {
                1: "• Estabelecer processos básicos de planejamento estratégico\n• Definir missão, visão e valores organizacionais\n• Implementar indicadores básicos de performance\n• Capacitar liderança em gestão estratégica",
                2: "• Formalizar processos de planejamento estratégico\n• Implementar sistema de monitoramento de KPIs\n• Desenvolver cultura de execução estratégica\n• Melhorar comunicação da estratégia",
                3: "• Implementar gestão de portfólio estratégico\n• Desenvolver capacidades de inovação\n• Fortalecer análise de cenários e riscos\n• Integrar sustentabilidade na estratégia",
                4: "• Manter excelência e buscar inovação contínua\n• Compartilhar melhores práticas no mercado\n• Desenvolver ecossistema de parceiros estratégicos\n• Liderar transformação digital do setor",
                5: "• Manter excelência e buscar inovação contínua\n• Compartilhar melhores práticas no mercado\n• Desenvolver ecossistema de parceiros estratégicos\n• Liderar transformação digital do setor"
            };
            return recommendations[level] || recommendations[1];
        }

        // Função para gerar análise detalhada por dimensão para email
        function generateDimensionAnalysisForEmail(dimensionAnalysis, assessmentData) {
            let analysisHtml = '';
            
            Object.keys(dimensionAnalysis).forEach(dimension => {
                const analysis = dimensionAnalysis[dimension];
                const recommendations = getDimensionRecommendations(dimension, analysis.level.level);
                
                analysisHtml += `
                <div style="margin-bottom: 30px; padding: 20px; border: 1px solid #e0e0e0; border-radius: 8px; background-color: #f9f9f9;">
                    <h3 style="color: #2c3e50; margin-bottom: 15px; font-size: 18px;">${dimension}</h3>
                    
                    <div style="margin-bottom: 15px;">
                        <p style="margin: 5px 0;"><strong>Pontuação:</strong> ${analysis.score} pontos</p>
                        <p style="margin: 5px 0;"><strong>Percentual:</strong> ${Math.round(analysis.percentage)}%</p>
                        <p style="margin: 5px 0;"><strong>Nível de Maturidade:</strong> ${analysis.level.level} - ${analysis.level.title}</p>
                    </div>
                    
                    <div style="background-color: #ffffff; padding: 15px; border-radius: 5px; border-left: 4px solid #3498db;">
                        <h4 style="color: #2c3e50; margin-bottom: 10px; font-size: 16px;">Descrição do Nível:</h4>
                        <p style="margin: 0; line-height: 1.6; color: #555;">${analysis.level.description}</p>
                    </div>
                    
                    <div style="background-color: #ffffff; padding: 15px; border-radius: 5px; border-left: 4px solid #27ae60; margin-top: 15px;">
                        <h4 style="color: #2c3e50; margin-bottom: 10px; font-size: 16px;">Recomendações Específicas:</h4>
                        <p style="margin: 0; line-height: 1.6; color: #555;">${recommendations}</p>
                    </div>
                </div>`;
            });
            
            return analysisHtml;
        }

        // Função para enviar relatório por email
        function sendEmailReport() {
            const assessmentData = JSON.parse(localStorage.getItem('stratica_assessment_result') || '{}');
            const dimensionAnalysis = analyzeDimensionScores(assessmentData.answers || {});
            
            // Gerar análise detalhada por dimensão
            const detailedAnalysis = generateDimensionAnalysisForEmail(dimensionAnalysis, assessmentData);
            
            // Criar resumo das dimensões
            let dimensionSummary = '';
            Object.keys(dimensionAnalysis).forEach(dimension => {
                const analysis = dimensionAnalysis[dimension];
                dimensionSummary += `${dimension}: ${Math.round(analysis.percentage)}% (Nível ${analysis.level.level})\n`;
            });
            
            const subject = `Relatório de Maturidade Estratégica - ${assessmentData.userInfo?.company || 'Sua Empresa'}`;
            const body = `Olá,

Segue o resultado completo do Assessment de Maturidade Estratégica:

=== RESULTADO GERAL ===
Nível: ${assessmentData.result?.level || 'N/A'} - ${assessmentData.result?.title || 'N/A'}
Descrição: ${assessmentData.result?.description || 'N/A'}
Pontuação Total: ${assessmentData.totalScore || 0} pontos
Percentual: ${Math.round(assessmentData.percentage || 0)}%

=== ANÁLISE DETALHADA POR DIMENSÃO ===
${Object.keys(dimensionAnalysis).map(dimension => {
    const analysis = dimensionAnalysis[dimension];
    const recommendations = getDimensionRecommendations(dimension, analysis.level.level);
    return `\n${dimension.toUpperCase()}:
• Pontuação: ${analysis.score} pontos (${Math.round(analysis.percentage)}%)
• Nível: ${analysis.level.level} - ${analysis.level.title}
• Descrição: ${analysis.level.description}
• Recomendações: ${recommendations}\n`;
}).join('\n')}

=== RESUMO POR DIMENSÃO ===
${dimensionSummary}

Para mais informações ou consultoria especializada, entre em contato conosco em stratica@stratica.com.br

Atenciosamente,
Equipe Stratica
www.stratica.com.br`;

            const mailtoLink = `mailto:${assessmentData.userInfo?.email || ''}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(mailtoLink);
        }

        document.addEventListener('DOMContentLoaded', function () {
            const quizData = [
                {
                    dimension: "Liderança",
                    icon: "crown",
                    weight: 100,
                    questions: [
                        {
                            id: "q1",
                            text: "A alta direção exerce liderança de forma estruturada e sistemática, com práticas definidas para interagir com todas as partes interessadas?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há práticas estruturadas de liderança ou interação com partes interessadas." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - práticas informais de liderança, com pouca interação estruturada." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - algumas práticas de liderança implementadas, mas não de forma consistente." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - práticas de liderança bem estruturadas e aplicadas na maioria das situações." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - liderança exemplar com práticas consistentes e eficazes em toda a organização." }
                            ]
                        },
                        {
                            id: "q2",
                            text: "A organização possui um sistema de liderança estruturado e implementado, com papéis, responsabilidades e processos claramente definidos?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não existe um sistema de liderança estruturado." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - sistema de liderança básico e informal." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - sistema de liderança parcialmente implementado." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - sistema de liderança bem estruturado e amplamente aplicado." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - sistema de liderança robusto, integrado e continuamente aprimorado." }
                            ]
                        },
                        {
                            id: "q3",
                            text: "A organização realiza análise crítica sistemática do desempenho global, utilizando indicadores abrangentes e metodologias estruturadas?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há análise crítica estruturada do desempenho." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - análises pontuais e informais do desempenho." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - análise crítica parcial com alguns indicadores." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - análise crítica sistemática com indicadores abrangentes." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - análise crítica robusta, integrada e orientada para melhoria contínua." }
                            ]
                        },
                        {
                            id: "q4",
                            text: "A alta direção demonstra comprometimento visível e consistente com a excelência e sustentabilidade através de ações concretas e comunicação eficaz?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há demonstração clara de comprometimento com excelência." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - comprometimento básico e esporádico." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - comprometimento parcial com algumas iniciativas." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - comprometimento claro e consistente na maioria das ações." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - comprometimento exemplar e inspirador em todas as dimensões." }
                            ]
                        }
                    ]
                },
                {
                    dimension: "Estratégias e Planos",
                    icon: "target",
                    weight: 70,
                    questions: [
                        {
                            id: "q5",
                            text: "A organização possui um processo estruturado e sistemático para formular suas estratégias, considerando análise de cenários, stakeholders e objetivos de longo prazo?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há processo estruturado de formulação de estratégias." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - processo básico e informal de definição estratégica." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - processo de formulação estratégica parcialmente estruturado." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - processo bem estruturado com metodologia definida." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - processo robusto, sistemático e continuamente aprimorado." }
                            ]
                        },
                        {
                            id: "q6",
                            text: "A organização implementa suas estratégias através de processos estruturados, com planos de ação detalhados, responsabilidades definidas e monitoramento sistemático?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há processo estruturado de implementação estratégica." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - implementação básica e informal das estratégias." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - implementação parcial com alguns mecanismos de controle." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - implementação sistemática com acompanhamento regular." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - implementação exemplar com gestão integrada e monitoramento contínuo." }
                            ]
                        },
                        {
                            id: "q7",
                            text: "Os planos de ação são elaborados de forma estruturada e detalhada, com objetivos claros, metas mensuráveis, prazos definidos e recursos alocados?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há elaboração estruturada de planos de ação." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - planos básicos e informais." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - planos parcialmente estruturados." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - planos bem elaborados e integrados." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - planos robustos, detalhados e continuamente atualizados." }
                            ]
                        }
                    ]
                },
                {
                    dimension: "Processos",
                    icon: "settings-2",
                    weight: 100,
                     questions: [
                        {
                            id: "q8",
                            text: "Os principais processos do negócio estão mapeados e documentados, com padrões definidos para garantir consistência?",
                            options: [
                                { value: 1, text: "Não fazemos isso - os processos não são formalizados." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - apenas alguns processos isolados foram mapeados." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - documentação para alguns processos, mas não se segue rigorosamente." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - a grande parte dos processos críticos está mapeada." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - todos os processos-chave estão mapeados e padronizados." }
                            ]
                        },
                        {
                            id: "q9",
                            text: "Existem indicadores de desempenho (KPIs) e metas estabelecidas para monitorar os processos ativamente?",
                             options: [
                                { value: 1, text: "Não fazemos isso - não medimos formalmente o desempenho dos processos." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - alguns indicadores básicos existem, sem metas." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - acompanhamento não é sistemático." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - a maioria dos processos importantes tem KPIs com metas." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - todos os processos críticos têm indicadores e metas." }
                            ]
                        },
                        {
                            id: "q10",
                            text: "A empresa utiliza práticas de melhoria contínua (PDCA, etc.) para otimizar seus processos de forma regular?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há nenhuma iniciativa estruturada de melhoria." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - realizamos melhorias pontuais, sem metodologia." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - aplicação esporádica ou não padronizada." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - a cultura de melhoria contínua está presente." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - a melhoria contínua está enraizada na cultura." }
                            ]
                        }
                    ]
                },
                 {
                    dimension: "Pessoas",
                    icon: "user-check",
                    weight: 70,
                     questions: [
                        {
                            id: "q11",
                            text: "A empresa investe no desenvolvimento dos colaboradores (treinamentos, capacitações) de forma planejada?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há investimentos significativos em treinamento." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - treinamentos básicos ou reativos." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - programas existem, mas sem cobrir todas as áreas." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - há um plano de desenvolvimento estruturado para boa parte da equipe." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - programa abrangente de desenvolvimento." }
                            ]
                        },
                        {
                            id: "q12",
                            text: "Existem processos estruturados de gestão de desempenho e feedback para os colaboradores?",
                             options: [
                                { value: 1, text: "Não fazemos isso - não há avaliação formal de desempenho nem feedback regular." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - processo informal de avaliação." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - avaliações periódicas, mas não consistentes." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - sistema de gestão de desempenho formal aplicado na maior parte." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - processo robusto de avaliação cobrindo todos." }
                            ]
                        },
                        {
                            id: "q13",
                            text: "A empresa promove um ambiente de trabalho positivo, com ações que estimulam o engajamento e a motivação?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há iniciativas deliberadas para melhorar o clima." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - realiza-se alguma ação pontual." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - algumas práticas de engajamento, mas não regulares." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - existem programas de engajamento relativamente abrangentes." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - a companhia valoriza as pessoas e isso se reflete no clima." }
                            ]
                        }
                    ]
                },
                {
                    dimension: "Clientes",
                    icon: "heart",
                    weight: 70,
                    questions: [
                        {
                            id: "q14",
                            text: "A organização possui métodos estruturados e sistemáticos para identificar, analisar e compreender as necessidades, expectativas e preferências dos seus clientes atuais e potenciais?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há nenhum processo estruturado para identificar necessidades dos clientes." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - identificação básica e informal das necessidades." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - processo parcial de identificação com alguns métodos." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - processo sistemático e abrangente de identificação." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - processo robusto, proativo e continuamente aprimorado." }
                            ]
                        },
                        {
                            id: "q15",
                            text: "Existe um sistema estruturado de gestão do relacionamento com clientes que garante atendimento de qualidade, comunicação eficaz e construção de vínculos duradouros?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há estratégia estruturada de relacionamento com clientes." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - relacionamento básico e reativo." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - algumas práticas de relacionamento implementadas." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - estratégia bem estruturada de relacionamento." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - relacionamento exemplar, proativo e personalizado." }
                            ]
                        },
                        {
                            id: "q16",
                            text: "A organização possui processos bem definidos para receber, analisar e resolver reclamações dos clientes, transformando-as em oportunidades de melhoria?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há processo estruturado para tratar reclamações." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - tratamento básico e informal das reclamações." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - processo parcial com alguns procedimentos definidos." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - processo bem estruturado e sistemático." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - processo exemplar com foco em prevenção e melhoria." }
                            ]
                        }
                    ]
                },
                {
                    dimension: "Sociedade",
                    icon: "globe",
                    weight: 70,
                    questions: [
                        {
                            id: "q17",
                            text: "A organização possui processos estruturados para identificar, analisar e compreender as necessidades e expectativas da sociedade em relação às suas atividades e impactos?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há nenhum processo para identificar necessidades da sociedade." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - identificação básica e informal das necessidades sociais." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - processo parcial de identificação com alguns métodos." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - processo sistemático e abrangente de identificação." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - processo robusto e proativo de identificação." }
                            ]
                        },
                        {
                            id: "q18",
                            text: "Os produtos, serviços e processos organizacionais são desenvolvidos considerando critérios de sustentabilidade ambiental e preservação dos recursos naturais?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há consideração ambiental no desenvolvimento." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - consideração básica e informal de aspectos ambientais." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - algumas práticas ambientais implementadas." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - estratégia bem estruturada de sustentabilidade." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - práticas exemplares de sustentabilidade integradas." }
                            ]
                        },
                        {
                            id: "q19",
                            text: "A organização implementa programas e ações estruturadas para promover o desenvolvimento social das comunidades onde atua?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há ações estruturadas de desenvolvimento social." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - ações básicas e esporádicas de responsabilidade social." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - algumas práticas de desenvolvimento social implementadas." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - programa bem estruturado de responsabilidade social." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - práticas exemplares de desenvolvimento social integradas." }
                            ]
                        }
                    ]
                },
                {
                    dimension: "Informações e Conhecimento",
                    icon: "database",
                    weight: 70,
                    questions: [
                        {
                            id: "q20",
                            text: "A organização possui processos estruturados para identificar, definir e priorizar as necessidades de informações críticas para a tomada de decisão e operação do negócio?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há processo para identificar necessidades de informações." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - identificação básica e informal das necessidades." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - processo parcial de identificação com alguns métodos." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - processo sistemático e abrangente de identificação." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - processo robusto e proativo de identificação." }
                            ]
                        },
                        {
                            id: "q21",
                            text: "Os sistemas de informação são desenvolvidos e implementados de forma estruturada para apoiar os processos organizacionais e facilitar a tomada de decisão?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há desenvolvimento estruturado de sistemas." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - desenvolvimento básico e informal." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - algumas práticas de desenvolvimento implementadas." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - processo bem estruturado de desenvolvimento." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - práticas exemplares de desenvolvimento integradas." }
                            ]
                        },
                        {
                            id: "q22",
                            text: "A organização desenvolve e gerencia sistematicamente seus ativos intangíveis, incluindo conhecimento, propriedade intelectual e competências organizacionais?",
                            options: [
                                { value: 1, text: "Não fazemos isso - não há gestão de ativos intangíveis." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - gestão básica e informal." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - algumas práticas de gestão implementadas." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - processo bem estruturado de gestão." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - práticas exemplares de gestão integradas." }
                            ]
                        }
                    ]
                },
                {
                    dimension: "Resultados",
                    icon: "bar-chart-3",
                    weight: 450,
                    questions: [
                        {
                            id: "q23",
                            text: "A organização apresenta resultados econômico-financeiros consistentes e sustentáveis que demonstram a eficácia de sua gestão e estratégias?",
                            options: [
                                { value: 1, text: "Não fazemos isso - resultados financeiros inadequados ou em declínio." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - resultados financeiros básicos, sem tendências claras." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - alguns resultados financeiros positivos." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - bons resultados financeiros com tendências favoráveis." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - excelentes resultados financeiros sustentáveis." }
                            ]
                        },
                        {
                            id: "q24",
                            text: "Os resultados relacionados a clientes e mercado demonstram a efetividade das estratégias de relacionamento e posicionamento competitivo da organização?",
                            options: [
                                { value: 1, text: "Não fazemos isso - resultados de clientes inadequados ou em declínio." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - resultados básicos de satisfação e retenção." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - alguns resultados positivos com clientes." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - bons resultados de satisfação e fidelização." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - excelentes resultados de relacionamento com clientes." }
                            ]
                        },
                        {
                            id: "q25",
                            text: "A organização alcança resultados significativos em suas contribuições para a sociedade e responsabilidade socioambiental?",
                            options: [
                                { value: 1, text: "Não fazemos isso - resultados sociais inadequados ou inexistentes." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - resultados básicos de responsabilidade social." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - alguns resultados positivos para a sociedade." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - bons resultados de impacto social." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - excelentes resultados de contribuição social." }
                            ]
                        },
                        {
                            id: "q26",
                            text: "Os resultados relacionados às pessoas evidenciam a efetividade das práticas de gestão de pessoas e o desenvolvimento do capital humano?",
                            options: [
                                { value: 1, text: "Não fazemos isso - resultados de pessoas inadequados." },
                                { value: 2, text: "Fazemos raramente ou de forma inicial - resultados básicos de satisfação dos colaboradores." },
                                { value: 3, text: "Fazemos parcialmente ou de forma inconsistente - alguns resultados positivos com pessoas." },
                                { value: 4, text: "Fazemos de forma ampla, porém não plena - bons resultados de engajamento e desenvolvimento." },
                                { value: 5, text: "Fazemos de forma consistente e eficaz em toda a empresa - excelentes resultados de gestão de pessoas." }
                            ]
                        }
                    ]
                }
            ];

            const quizContainer = document.getElementById('quiz-container');
            const form = document.getElementById('maturity-quiz-form');
            const resultadoSection = document.getElementById('resultado');
            let totalQuestions = 0;

            // Função para gerar o HTML do questionário
            function renderQuiz() {
                quizData.forEach(dimension => {
                    totalQuestions += dimension.questions.length;

                    let dimensionHtml = `
                        <div class="dimension-group">
                            <div class="flex items-center mb-6">
                                <div class="flex items-center justify-center h-12 w-12 rounded-full bg-red-100 text-red-700 mr-4">
                                    <i data-lucide="${dimension.icon}" class="w-6 h-6"></i>
                                </div>
                                <h2 class="text-3xl font-bold text-gray-800">${dimension.dimension}</h2>
                            </div>
                            <div class="space-y-8">
                    `;

                    dimension.questions.forEach((question, index) => {
                        dimensionHtml += `
                            <div class="bg-gray-50 p-6 rounded-lg shadow-sm question-card">
                                <p class="font-semibold text-lg mb-4">${question.text}</p>
                                <div class="space-y-3">
                        `;
                        question.options.forEach(option => {
                            dimensionHtml += `
                                <label class="flex items-start text-gray-700 cursor-pointer">
                                    <input type="radio" name="${question.id}" value="${option.value}" class="radio-custom" required>
                                    <span>${option.text}</span>
                                </label>
                            `;
                        });
                        dimensionHtml += `</div></div>`;
                    });

                    dimensionHtml += `</div></div>`;
                    quizContainer.innerHTML += dimensionHtml;
                });
                lucide.createIcons(); // Renderiza os ícones
            }

            // Função para calcular e exibir o resultado
            function calculateAndShowResult(event) {
                event.preventDefault();

                const formData = new FormData(form);
                let totalStraticaScore = 0;
                let allQuestionsAnswered = true;
                const answers = {};
                const dimensionScores = {};

                quizData.forEach(dim => {
                    let dimensionScore = 0;
                    let dimensionQuestions = 0;
                    
                    dim.questions.forEach(q => {
                        const answer = formData.get(q.id);
                        if (answer) {
                            const score = parseInt(answer);
                            dimensionScore += score;
                            answers[q.id] = {
                                question: q.text,
                                answer_text: q.options.find(opt => opt.value === score).text,
                                score: score
                            };
                        } else {
                            allQuestionsAnswered = false;
                        }
                        dimensionQuestions++;
                    });
                    
                    // Calcular pontuação Stratica para esta dimensão
                    const dimensionPercentage = (dimensionScore / (dimensionQuestions * 5)) * 100;
                    const dimensionWeight = dim.weight || 60; // peso padrão se não especificado
                    const straticaScore = Math.round((dimensionPercentage / 100) * dimensionWeight);
                    
                    dimensionScores[dim.dimension] = {
                        score: dimensionScore,
                        maxScore: dimensionQuestions * 5,
                        percentage: Math.round(dimensionPercentage),
                        straticaScore: straticaScore,
                        weight: dimensionWeight
                    };
                    
                    totalStraticaScore += straticaScore;
                });

                if (!allQuestionsAnswered) {
                    alert("Por favor, responda todas as perguntas antes de continuar.");
                    return;
                }

                const maxStraticaScore = 1000; // Total máximo Stratica
                const percentage = (totalStraticaScore / maxStraticaScore) * 100;
                
                displayResult(percentage, totalStraticaScore, dimensionScores);
                sendData({
                    userInfo: {
                        name: formData.get('name'),
                        email: formData.get('email'),
                        company: formData.get('company'),
                        position: formData.get('position')
                    },
                    result: getResultDetailsStratica(totalStraticaScore),
                    totalStraticaScore: totalStraticaScore,
                    dimensionScores: dimensionScores,
                    answers: answers
                });

                resultadoSection.scrollIntoView({ behavior: 'smooth' });
            }

            // Função para exibir o resultado no DOM
            function displayResult(percentage, totalStraticaScore, dimensionScores) {
                const percentageResultEl = document.getElementById('percentage-result');
                const resultBarEl = document.getElementById('result-bar');
                const levelTitleEl = document.getElementById('level-title');
                const levelDescriptionEl = document.getElementById('level-description');
                
                const { level, title, description } = getResultDetailsStratica(totalStraticaScore);

                percentageResultEl.textContent = `${totalStraticaScore}/1000 pontos Stratica (${Math.round(percentage)}%)`;
                levelTitleEl.textContent = `Nível ${level} - ${title}`;
                levelDescriptionEl.textContent = description;

                // Animação da barra de progresso
                setTimeout(() => {
                     resultBarEl.style.width = `${percentage}%`;
                }, 100);

                // Exibir análise por dimensão
                displayDimensionAnalysis(dimensionScores);

                resultadoSection.classList.remove('hidden');
            }

            // Função para exibir análise detalhada por critério
            function displayDimensionAnalysis(dimensionScores) {
                // Verificar se já existe um container de análise
                let analysisContainer = document.getElementById('dimension-analysis-container');
                if (!analysisContainer) {
                    analysisContainer = document.createElement('div');
                    analysisContainer.id = 'dimension-analysis-container';
                    analysisContainer.className = 'mt-12 pt-8 border-t border-gray-600';
                    document.getElementById('resultado').appendChild(analysisContainer);
                }
                
                let analysisHTML = '<div class="container mx-auto px-6"><h3 class="text-xl font-bold mb-6 text-white">Análise Detalhada por Dimensão</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4">';
                
                for (const [dimension, data] of Object.entries(dimensionScores)) {
                    const percentage = Math.round((data.score / data.maxScore) * 100);
                    const dimensionPercentage = (data.score / data.maxScore) * 100;
                        const levelNumber = getDimensionLevel(dimensionPercentage);
                    const levelDetails = getResultDetailsForDimension(levelNumber);
                    
                    analysisHTML += `
                        <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                            <h4 class="font-semibold text-lg mb-4 text-gray-800">${dimension}</h4>
                            <div class="flex justify-between items-center mb-3">
                                <span class="text-sm font-medium text-gray-700">${data.score}/${data.maxScore} pontos</span>
                                <span class="text-sm text-gray-600">(${percentage}%)</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-3 mb-3">
                                <div class="bg-blue-600 h-3 rounded-full transition-all duration-500" style="width: ${percentage}%"></div>
                            </div>
                            <div class="text-center mb-4">
                                <span class="inline-block px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800">Nível ${levelNumber} - ${levelDetails.title}</span>
                            </div>
                            <div class="text-sm text-gray-700 leading-relaxed">
                                <strong class="text-gray-800">Recomendações Específicas:</strong>
                                <p class="mt-2 p-3 bg-green-50 border-l-4 border-green-400 rounded">${getDimensionRecommendations(dimension, levelNumber)}</p>
                            </div>
                        </div>
                    `;
                }
                
                analysisHTML += '</div></div>';
                analysisContainer.innerHTML = analysisHTML;
            }

            // Função para obter recomendações específicas por critério e nível
            function getDimensionRecommendations(dimension, level) {
                const recommendations = {
                    'Liderança': {
                        1: 'Inicie estabelecendo uma visão organizacional clara e valores fundamentais que orientem todas as decisões da empresa. Defina papéis e responsabilidades de liderança em cada nível hierárquico, criando descrições de cargo específicas para posições de gestão. Implemente reuniões regulares de equipe para melhorar a comunicação interna e estabeleça canais formais de feedback. Desenvolva competências básicas de liderança através de treinamentos introdutórios, mentoring informal e leitura de literatura especializada, focando em construir relacionamentos de confiança com os colaboradores.',
                        2: 'Desenvolva um programa estruturado de capacitação em competências de liderança, incluindo comunicação eficaz, gestão de conflitos e tomada de decisão. Implemente sistemas regulares de comunicação com as equipes através de reuniões one-on-one, newsletters internas e canais digitais de comunicação. Estabeleça processos de avaliação de desempenho para líderes e crie planos de desenvolvimento individual. Invista em ferramentas de gestão de pessoas e comece a monitorar indicadores básicos de clima organizacional e engajamento das equipes.',
                        3: 'Formalize processos robustos de governança corporativa com comitês de gestão, políticas claras de delegação de autoridade e procedimentos estruturados de tomada de decisão. Estabeleça indicadores específicos de desempenho da liderança, incluindo métricas de engajamento, turnover e produtividade das equipes. Desenvolva programas de sucessão para posições-chave e implemente trilhas de carreira bem definidas. Crie sistemas de reconhecimento e recompensa alinhados aos valores organizacionais e promova a cultura de feedback contínuo em todos os níveis.',
                        4: 'Implemente práticas avançadas de liderança participativa e colaborativa, envolvendo equipes nas decisões estratégicas e operacionais através de comitês multifuncionais e grupos de trabalho. Desenvolva um pipeline robusto de sucessores através de programas estruturados de mentoring, job rotation e projetos desafiadores. Adote metodologias ágeis de gestão e promova maior autonomia das equipes, estabelecendo centros de excelência em liderança. Crie redes internas de líderes para compartilhamento de melhores práticas e aprendizado colaborativo.',
                        5: 'Pratique liderança transformacional de alto nível, focada em inspirar e motivar equipes para alcançar resultados excepcionais e superar expectativas. Promova uma cultura organizacional de inovação contínua, experimentação controlada e aprendizado com falhas. Desenvolva líderes capazes de conduzir mudanças complexas e transformações organizacionais profundas. Implemente sistemas avançados de gestão de talentos com foco em diversidade, inclusão e bem-estar, criando um ambiente de alta performance onde as pessoas se sintam valorizadas e engajadas.',
                        6: 'Torne-se uma referência reconhecida em práticas inovadoras de liderança, compartilhando conhecimento através de publicações especializadas, palestras em eventos do setor e parcerias com universidades renomadas. Desenvolva modelos proprietários de liderança que possam ser estudados e replicados por outras organizações. Lidere iniciativas setoriais de desenvolvimento de lideranças e estabeleça parcerias estratégicas com centros de pesquisa em gestão. Crie um legado duradouro de líderes excepcionais que impactem positivamente todo o ecossistema empresarial e social.'
                    },
                    'Estratégias e Planos': {
                        1: 'Comece definindo claramente a missão, visão e valores organizacionais através de workshops participativos envolvendo lideranças e colaboradores-chave da empresa. Estabeleça objetivos SMART de curto prazo (3-6 meses) que sejam específicos, mensuráveis, alcançáveis, relevantes e temporais, alinhados com a realidade atual da organização. Crie um documento básico de planejamento estratégico e comunique amplamente para toda a organização através de reuniões, murais e canais digitais. Implemente reuniões mensais de acompanhamento para revisar o progresso dos objetivos e ajustar rumos quando necessário.',
                        2: 'Desenvolva um processo formal e estruturado de planejamento estratégico anual, utilizando metodologias reconhecidas e estabelecendo um cronograma claro com marcos e responsabilidades definidas. Realize um mapeamento completo de stakeholders internos e externos, identificando suas expectativas, influências e impactos na organização. Implemente análises básicas de mercado, concorrência e ambiente competitivo para fundamentar decisões estratégicas. Estabeleça um comitê estratégico multifuncional e crie sistemas regulares de comunicação sobre o progresso da estratégia para todos os níveis organizacionais.',
                        3: 'Implemente análises SWOT sistemáticas e outras ferramentas avançadas de diagnóstico estratégico como análise PESTEL, Cinco Forças de Porter e matriz BCG para uma compreensão profunda do ambiente de negócios. Desenvolva planos de ação detalhados e estruturados com responsáveis claramente definidos, prazos específicos, recursos necessários e marcos de controle para cada iniciativa estratégica. Estabeleça um escritório de projetos estratégicos para coordenar a execução e monitoramento contínuo. Crie dashboards interativos de acompanhamento com indicadores-chave de performance estratégica e realize revisões trimestrais rigorosas do plano.',
                        4: 'Integre completamente o planejamento estratégico com a execução operacional através do desdobramento sistemático de metas e implementação de OKRs (Objectives and Key Results) em todos os níveis organizacionais. Implemente sistemas avançados de monitoramento estratégico com indicadores leading e lagging, utilizando business intelligence e analytics. Desenvolva capacidades robustas de gestão de portfólio de projetos estratégicos e estabeleça processos estruturados de gestão de riscos estratégicos. Crie mecanismos ágeis de feedback contínuo do mercado e stakeholders para permitir ajustes rápidos e eficazes na estratégia.',
                        5: 'Pratique gestão estratégica de classe mundial utilizando inteligência competitiva avançada, análise sofisticada de cenários futuros e técnicas de war gaming para antecipação de movimentos competitivos. Desenvolva capacidades superiores de antecipação de tendências através de parcerias estratégicas com centros de pesquisa, think tanks e universidades de ponta. Implemente metodologias inovadoras como blue ocean strategy, design thinking estratégico e laboratórios de inovação para identificar e testar novas oportunidades de negócio. Estabeleça processos avançados de strategic foresight e inteligência de mercado.',
                        6: 'Torne-se um benchmark reconhecido globalmente em estratégia empresarial, desenvolvendo metodologias proprietárias inovadoras e cases de sucesso que sejam estudados e replicados pelo mercado. Influencie ativamente o desenvolvimento do setor através de liderança em associações empresariais, participação em fóruns estratégicos internacionais e publicação de pesquisas relevantes. Estabeleça parcerias estratégicas de longo prazo com universidades de prestígio mundial para pesquisa e desenvolvimento de novas abordagens estratégicas. Crie um centro de excelência em estratégia que sirva como referência e inspire outras organizações a elevar seus padrões de planejamento estratégico.'
                    },
                    'Clientes': {
                        1: 'Inicie um processo estruturado de identificação e mapeamento dos seus clientes principais através de pesquisas diretas, análise de dados de vendas e observação comportamental. Estabeleça canais básicos de comunicação diretos e acessíveis como telefone, email, WhatsApp Business e redes sociais, garantindo tempos de resposta adequados e atendimento humanizado. Crie um banco de dados básico de clientes com informações essenciais como dados demográficos, histórico de compras e preferências. Implemente um sistema simples de feedback e reclamações, respondendo prontamente a todas as manifestações dos clientes.',
                        2: 'Implemente pesquisas estruturadas de satisfação utilizando metodologias como NPS (Net Promoter Score), CSAT (Customer Satisfaction Score) e questionários pós-venda para medir sistematicamente a experiência do cliente. Desenvolva um relacionamento mais próximo e personalizado através de ações como newsletters personalizadas, promoções exclusivas e comunicação regular sobre novidades e benefícios. Estabeleça um processo formal de gestão de reclamações com prazos definidos para resolução e acompanhamento pós-resolução. Crie um sistema de CRM básico para centralizar informações e histórico de interações com cada cliente.',
                        3: 'Implemente segmentação avançada de clientes baseada em valor, comportamento de compra, potencial de crescimento e ciclo de vida, utilizando análises RFM (Recência, Frequência, Valor Monetário) e outras técnicas estatísticas. Desenvolva estratégias personalizadas de atendimento e ofertas para cada segmento, criando campanhas direcionadas e relevantes. Monitore sistematicamente a experiência do cliente através de múltiplos pontos de contato, coletando feedback contínuo e implementando melhorias baseadas em dados. Estabeleça programas de fidelidade diferenciados por segmento e implemente automação de marketing para nutrir relacionamentos de forma escalável.',
                        4: 'Pratique gestão de relacionamento avançada utilizando analytics e business intelligence para extrair insights profundos sobre comportamento, preferências e padrões de consumo dos clientes. Desenvolva capacidades superiores para antecipar necessidades dos clientes através de análise preditiva, pesquisa de tendências e co-criação com clientes. Implemente uma jornada do cliente verdadeiramente omnichannel, integrando todos os pontos de contato físicos e digitais para proporcionar uma experiência fluida e consistente. Estabeleça sistemas de real-time personalization e recommendation engines para oferecer experiências altamente relevantes.',
                        5: 'Torne-se uma referência reconhecida em experiência do cliente através da implementação de metodologias de design thinking centradas no cliente e criação de laboratórios de inovação focados em CX. Inove constantemente na proposta de valor através de pesquisa contínua de mercado, análise de tendências emergentes e desenvolvimento de soluções disruptivas que superem expectativas. Implemente programas de customer advocacy e embaixadores da marca, transformando clientes satisfeitos em promotores ativos. Estabeleça centros de excelência em customer experience com equipes dedicadas e processos de melhoria contínua.',
                        6: 'Lidere a transformação no relacionamento com clientes no seu setor, desenvolvendo metodologias inovadoras de experiência do cliente que sejam estudadas e replicadas por outras organizações do mercado. Influencie ativamente os padrões de customer experience da indústria através de liderança em associações, participação em conferências internacionais e publicação de pesquisas relevantes. Estabeleça parcerias estratégicas com universidades e centros de pesquisa para desenvolvimento de novas abordagens em customer science. Crie um ecossistema de inovação centrado no cliente que inspire e eleve os padrões de toda a indústria.'
                    },
                    'Sociedade': {
                        1: 'Inicie um processo de identificação e mapeamento dos impactos sociais básicos da sua organização através de diagnósticos participativos envolvendo colaboradores, comunidade local e stakeholders relevantes. Estabeleça um programa rigoroso de cumprimento da legislação ambiental e social, criando check-lists de conformidade e realizando auditorias internas regulares. Implemente práticas básicas de responsabilidade social como separação de resíduos, uso consciente de recursos naturais e respeito aos direitos trabalhistas. Crie canais de comunicação com a comunidade local para receber feedback sobre impactos das operações.',
                        2: 'Desenvolva programas estruturados de responsabilidade social corporativa alinhados com os Objetivos de Desenvolvimento Sustentável (ODS) da ONU, estabelecendo metas claras, cronogramas e indicadores de impacto. Engaje ativamente a comunidade local através de parcerias com ONGs, escolas e organizações comunitárias, desenvolvendo projetos de educação, capacitação profissional e geração de renda. Implemente políticas de diversidade e inclusão no ambiente de trabalho e estabeleça programas de voluntariado corporativo. Crie relatórios anuais de sustentabilidade para comunicar transparentemente as ações e resultados.',
                        3: 'Implemente um sistema de gestão ambiental estruturado baseado em normas como ISO 14001, estabelecendo políticas ambientais claras, objetivos mensuráveis e programas de treinamento para todos os colaboradores. Monitore sistematicamente os impactos socioambientais através de indicadores específicos como pegada de carbono, consumo de água, geração de resíduos e impactos na biodiversidade. Desenvolva programas de economia circular, redução de desperdícios e uso de energias renováveis. Estabeleça parcerias com fornecedores que compartilhem valores de sustentabilidade.',
                        4: 'Integre completamente a sustentabilidade à estratégia organizacional, incorporando critérios ESG (Environmental, Social and Governance) em todos os processos de tomada de decisão e planejamento estratégico. Promova desenvolvimento social ativo através de investimento social privado, criação de negócios sociais e desenvolvimento de cadeias produtivas sustentáveis. Implemente sistemas avançados de gestão de riscos socioambientais e desenvolva produtos e serviços com impacto social positivo. Estabeleça metas science-based para redução de emissões e outros impactos ambientais.',
                        5: 'Torne-se uma referência reconhecida em sustentabilidade no seu setor através da implementação de práticas inovadoras, obtenção de certificações internacionais e participação em índices de sustentabilidade. Lidere iniciativas setoriais de sustentabilidade através de associações empresariais, fóruns de sustentabilidade e parcerias estratégicas com outras organizações. Desenvolva tecnologias e metodologias próprias para soluções sustentáveis e compartilhe conhecimento através de publicações e eventos. Implemente programas de regeneração ambiental que vão além da neutralidade de impactos.',
                        6: 'Transforme positivamente a sociedade através de iniciativas disruptivas que criem valor compartilhado e solucionem grandes desafios socioambientais globais. Torne-se um modelo global de sustentabilidade, influenciando políticas públicas, padrões setoriais e práticas empresariais em escala internacional. Estabeleça parcerias estratégicas com governos, organizações multilaterais e academia para desenvolvimento de soluções sistêmicas. Crie um legado duradouro de impacto positivo que inspire e transforme toda a cadeia de valor e a sociedade como um todo.'
                    },
                    'Informações e Conhecimento': {
                        1: 'Inicie um processo de organização das informações básicas da empresa através da criação de repositórios centralizados, padronização de nomenclaturas e estabelecimento de hierarquias claras de acesso. Estabeleça sistemas básicos de comunicação interna utilizando ferramentas como email corporativo, murais informativos e reuniões regulares para garantir fluxo adequado de informações. Implemente controles básicos de segurança da informação e backup de dados críticos. Crie procedimentos simples para documentação de processos e conhecimentos essenciais da organização.',
                        2: 'Implemente sistemas estruturados de gestão de informações utilizando ferramentas de TI adequadas como sistemas ERP básicos, plataformas de colaboração e bancos de dados organizados. Desenvolva uma base de conhecimento organizacional através da documentação sistemática de processos, melhores práticas, lições aprendidas e expertise dos colaboradores. Estabeleça políticas claras de gestão da informação incluindo classificação, retenção e descarte de documentos. Crie programas de treinamento para capacitar colaboradores no uso efetivo dos sistemas de informação.',
                        3: 'Estruture um sistema abrangente de gestão do conhecimento implementando comunidades de prática, repositórios especializados e processos formais de captura e transferência de conhecimento tácito. Monitore sistematicamente a qualidade das informações através de indicadores específicos como precisão, completude, atualidade e relevância dos dados. Implemente ferramentas avançadas de business intelligence para análise e visualização de dados. Estabeleça governança de dados com responsabilidades claras e processos de validação contínua.',
                        4: 'Integre completamente os sistemas de informação da organização através de plataformas unificadas, APIs e interfaces que permitam fluxo seamless de dados entre diferentes áreas e processos. Promova ativamente o compartilhamento de conhecimento através de programas de mentoring, workshops internos, wikis corporativas e sistemas de gestão de competências. Implemente analytics avançados e inteligência artificial para extrair insights estratégicos dos dados. Desenvolva capacidades de gestão de big data e análise preditiva para suporte à tomada de decisões.',
                        5: 'Pratique gestão avançada do conhecimento utilizando tecnologias de ponta como machine learning, processamento de linguagem natural e sistemas de recomendação para otimizar a descoberta e aplicação de conhecimento. Use analytics sofisticados e ciência de dados para fundamentar decisões estratégicas, identificar padrões ocultos e antecipar tendências. Implemente sistemas de knowledge management que aprendem continuamente e se adaptam às necessidades da organização. Estabeleça parcerias com universidades e centros de pesquisa para acesso a conhecimento de fronteira.',
                        6: 'Torne-se uma referência global em gestão da informação e conhecimento no seu setor, desenvolvendo metodologias inovadoras e tecnologias proprietárias que sejam estudadas e replicadas por outras organizações. Influencie o desenvolvimento de padrões e melhores práticas da indústria através de liderança em associações, publicação de pesquisas e participação em fóruns internacionais. Estabeleça ecossistemas de conhecimento que conectem a organização com redes globais de expertise. Crie centros de excelência que sirvam como referência e inspirem a evolução das práticas de gestão do conhecimento em toda a indústria.'
                    },
                    'Pessoas': {
                        1: 'Organize uma estrutura básica de recursos humanos estabelecendo políticas fundamentais de contratação, demissão e gestão de pessoal, criando um manual do colaborador com direitos e deveres claramente definidos. Defina descrições detalhadas de cargos e responsabilidades para todas as posições, estabelecendo organogramas claros e linhas de reporte bem definidas. Implemente controles básicos de ponto, folha de pagamento e benefícios obrigatórios. Crie processos simples de integração de novos colaboradores e estabeleça canais básicos de comunicação interna.',
                        2: 'Implemente processos estruturados de recrutamento e seleção utilizando técnicas modernas de entrevista, testes de competência e verificação de referências para atrair e selecionar os melhores talentos. Desenvolva programas básicos de treinamento e desenvolvimento profissional alinhados com as necessidades da organização e aspirações dos colaboradores. Melhore significativamente a comunicação interna através de reuniões regulares, newsletters, murais informativos e canais digitais. Estabeleça políticas claras de avaliação de desempenho e feedback contínuo.',
                        3: 'Estruture um sistema abrangente de gestão de competências mapeando as competências técnicas e comportamentais necessárias para cada função e desenvolvendo planos individuais de desenvolvimento. Monitore regularmente o clima organizacional através de pesquisas estruturadas, grupos focais e indicadores de satisfação, implementando ações corretivas baseadas nos resultados. Implemente programas de sucessão e planos de carreira claros. Desenvolva lideranças internas através de programas de mentoring e coaching.',
                        4: 'Pratique gestão de talentos avançada utilizando analytics de RH, inteligência artificial para recrutamento e sistemas sofisticados de gestão de performance que identifiquem e desenvolvam high performers. Promova ativamente o engajamento e bem-estar dos colaboradores através de programas de qualidade de vida, flexibilidade no trabalho, reconhecimento e recompensas diferenciadas. Implemente cultura de feedback contínuo, diversidade e inclusão. Desenvolva programas inovadores de retenção de talentos e employer branding.',
                        5: 'Torne-se uma referência reconhecida em gestão de pessoas no seu setor através da implementação de práticas inovadoras de people analytics, employee experience design e future of work. Inove constantemente em práticas de RH desenvolvendo metodologias próprias de desenvolvimento humano, programas de well-being holísticos e modelos de trabalho flexíveis que sirvam de benchmark. Implemente tecnologias de ponta como IA para personalização de experiências e desenvolvimento de competências. Estabeleça parcerias com universidades para pesquisa em gestão de pessoas.',
                        6: 'Transforme positivamente o mercado de trabalho através de iniciativas disruptivas que redefinam padrões de gestão de pessoas, influenciando políticas públicas e práticas empresariais em escala global. Torne-se um modelo global em gestão de pessoas, sendo estudado e replicado por organizações de todo o mundo. Desenvolva e compartilhe metodologias inovadoras que elevem os padrões da profissão de RH. Crie um legado duradouro de impacto positivo na vida das pessoas e na evolução das práticas de gestão humana.'
                    },
                    'Processos': {
                        1: 'Mapeie e documente os processos principais da organização identificando as atividades críticas, responsáveis e fluxos de trabalho essenciais para o funcionamento básico do negócio. Estabeleça controles básicos de qualidade através de verificações simples, checklists fundamentais e registros mínimos que garantam a conformidade das operações. Defina claramente as entradas, saídas e responsabilidades de cada processo principal. Identifique e corrija os problemas mais evidentes que impactam diretamente a qualidade e eficiência.',
                        2: 'Padronize sistematicamente os processos críticos criando procedimentos operacionais padrão (POPs) detalhados, templates e formulários que garantam consistência na execução das atividades. Implemente melhorias pontuais baseadas em análises simples de causa e efeito, eliminando desperdícios óbvios e gargalos identificados. Treine as equipes nos processos padronizados e estabeleça rotinas básicas de verificação e controle. Documente as melhores práticas e crie um sistema simples de gestão do conhecimento.',
                        3: 'Estruture uma gestão por processos abrangente mapeando todos os processos organizacionais, suas interações e dependências, criando uma visão sistêmica da operação. Monitore continuamente indicadores de desempenho através de métricas específicas, dashboards básicos e relatórios regulares que permitam acompanhar a eficiência e eficácia dos processos. Implemente ciclos de revisão e melhoria contínua. Desenvolva competências internas em gestão de processos e estabeleça responsáveis por cada processo.',
                        4: 'Otimize processos continuamente utilizando metodologias avançadas como Lean, Six Sigma e BPM para eliminar desperdícios, reduzir variabilidade e melhorar significativamente a performance operacional. Integre efetivamente a cadeia de valor interna e externa, sincronizando processos com fornecedores e clientes para criar fluxos otimizados e reduzir tempos de ciclo. Implemente automação inteligente e tecnologias que aumentem a produtividade. Desenvolva uma cultura de melhoria contínua em toda a organização.',
                        5: 'Pratique excelência operacional reconhecida no mercado através da implementação de práticas de classe mundial em gestão de processos que sirvam de referência para outras organizações. Inove constantemente em processos e tecnologias desenvolvendo soluções próprias, utilizando inteligência artificial, analytics avançados e tecnologias emergentes para criar vantagens competitivas sustentáveis. Estabeleça centros de excelência e compartilhe conhecimento através de publicações e benchmarking.',
                        6: 'Torne-se um benchmark reconhecido globalmente em gestão de processos, sendo estudado e replicado por organizações de todo o mundo devido à excelência e inovação de suas práticas operacionais. Lidere a transformação setorial através do desenvolvimento de processos revolucionários que redefinam padrões de eficiência, qualidade e sustentabilidade, influenciando toda a cadeia de valor e ecossistema empresarial. Desenvolva e licencie metodologias inovadoras que elevem os padrões da gestão de processos globalmente.'
                    },
                    'Resultados': {
                        1: 'Monitore sistematicamente os resultados financeiros básicos através de controles de receitas, custos e fluxo de caixa, estabelecendo relatórios mensais simples que permitam acompanhar a saúde financeira da organização. Estabeleça controles rigorosos de custos implementando orçamentos básicos, análise de variações e aprovações para gastos significativos. Defina indicadores financeiros fundamentais como margem de lucro, ponto de equilíbrio e retorno sobre investimento. Crie rotinas de análise e tomada de decisão baseada em dados financeiros.',
                        2: 'Implemente um sistema abrangente de indicadores de desempenho (KPIs) que cubra as principais áreas do negócio, incluindo métricas financeiras, operacionais, de qualidade e produtividade. Monitore regularmente a satisfação de clientes através de pesquisas estruturadas, NPS, análise de reclamações e feedback contínuo, implementando ações corretivas baseadas nos resultados. Estabeleça metas claras e acompanhe o progresso através de dashboards e relatórios regulares. Desenvolva uma cultura de orientação por resultados.',
                        3: 'Estruture um sistema integrado de medição de desempenho que conecte indicadores estratégicos, táticos e operacionais, criando uma visão holística dos resultados organizacionais através de balanced scorecards ou metodologias similares. Analise sistematicamente tendências históricas, comparações setoriais e benchmarking interno para identificar oportunidades de melhoria e padrões de performance. Implemente analytics avançados e relatórios automatizados. Desenvolva competências internas em análise de dados e business intelligence.',
                        4: 'Pratique gestão por resultados avançada utilizando metodologias sofisticadas de análise de performance, predição de tendências e otimização de recursos que maximizem o retorno sobre investimentos. Implemente benchmarking sistemático com concorrentes e empresas de classe mundial, identificando gaps de performance e oportunidades de diferenciação competitiva. Utilize analytics preditivos e inteligência artificial para antecipar resultados e otimizar decisões. Desenvolva uma cultura de alta performance e accountability.',
                        5: 'Alcance e sustente resultados superiores reconhecidos no mercado, posicionando a organização como referência de excelência no setor através de performance consistentemente acima da média e práticas inovadoras de gestão. Torne-se referência no setor através de resultados excepcionais em todas as dimensões do negócio, sendo estudado e benchmarkado por outras organizações. Desenvolva capacidades distintivas que gerem vantagens competitivas sustentáveis. Compartilhe conhecimento e melhores práticas através de publicações e eventos.',
                        6: 'Transforme os padrões de desempenho do mercado através de resultados revolucionários que redefinam o que é possível alcançar no setor, influenciando toda a cadeia de valor e estabelecendo novos benchmarks globais. Torne-se um líder global reconhecido pela excelência em resultados, sendo estudado por organizações de todo o mundo e servindo como modelo de performance excepcional. Desenvolva e compartilhe metodologias inovadoras de gestão de resultados que elevem os padrões de toda a indústria.'
                    }
                };
                
                return recommendations[dimension] && recommendations[dimension][level] 
                    ? recommendations[dimension][level] 
                    : 'Continue desenvolvendo este critério para alcançar melhores resultados.';
            }

            // Função para obter o nível de uma dimensão específica baseado no seu peso
            function getDimensionLevel(dimensionPercentage) {
                // Usar intervalos baseados na porcentagem (0-100%) - Nova escala
                if (dimensionPercentage <= 20) {
                    return 1;   // 0-200 pontos (0-20%)
                } else if (dimensionPercentage <= 35) {
                    return 2;   // 201-350 pontos (20.1-35%)
                } else if (dimensionPercentage <= 50) {
                    return 3;   // 351-500 pontos (35.1-50%)
                } else if (dimensionPercentage <= 65) {
                    return 4;   // 501-650 pontos (50.1-65%)
                } else if (dimensionPercentage <= 80) {
                    return 5;   // 651-800 pontos (65.1-80%)
                } else {
                    return 6;   // 801-1000 pontos (80.1-100%)
                }
            }

            // Função para obter os detalhes do nível de maturidade Stratica
            function getResultDetailsStratica(straticaScore) {
                if (straticaScore <= 200) {
                    return {
                        level: 1,
                        title: "Limitado",
                        description: "Maturidade muito baixa (0-200 pontos). Práticas de gestão inexistentes ou ad-hoc, resultados obtidos de forma não estruturada. A organização depende de esforços isolados."
                    };
                } else if (straticaScore <= 350) {
                    return {
                        level: 2,
                        title: "Emergente",
                        description: "Maturidade baixa (201-350 pontos). Início de implementação básica de algumas práticas, de modo informal e pontual. A empresa reconhece a importância de melhorar, mas não há consistência."
                    };
                } else if (straticaScore <= 500) {
                    return {
                        level: 3,
                        title: "Desenvolvido",
                        description: "Maturidade intermediária (351-500 pontos). Processos e práticas já formalizados, porém aplicados de maneira parcial ou descoordenada. Os elementos de gestão não são uniformes."
                    };
                } else if (straticaScore <= 650) {
                    return {
                        level: 4,
                        title: "Gerenciado",
                        description: "Maturidade alta (501-650 pontos). Práticas de gestão bem estabelecidas e coordenadas, aplicadas de forma consistente. A gestão é efetiva e proativa na maior parte da empresa."
                    };
                } else if (straticaScore <= 800) {
                    return {
                        level: 5,
                        title: "Integrado",
                        description: "Maturidade muito alta (651-800 pontos). Excelência gerencial, com práticas integradas à cultura e melhoria contínua. A empresa é referência e possui desempenho superior e sustentado."
                    };
                } else {
                    return {
                        level: 6,
                        title: "Excelente",
                        description: "Maturidade excepcional (801-1000 pontos). Organização de classe mundial com práticas inovadoras, resultados excepcionais e reconhecimento como benchmark de mercado."
                    };
                }
            }

            // Função para obter os detalhes do nível de maturidade (mantida para compatibilidade)
            function getResultDetails(percentage) {
                const straticaScore = Math.round((percentage / 100) * 1000);
                return getResultDetailsStratica(straticaScore);
            }

            // Função para obter os detalhes do nível de maturidade baseado no nível calculado por dimensão
            function getResultDetailsForDimension(levelNumber) {
                switch(levelNumber) {
                    case 1:
                        return {
                            level: 1,
                            title: "Limitado",
                            description: "Maturidade muito baixa (0-200 pontos). Práticas de gestão inexistentes ou ad-hoc, resultados obtidos de forma não estruturada. A organização depende de esforços isolados."
                        };
                    case 2:
                        return {
                            level: 2,
                            title: "Emergente",
                            description: "Maturidade baixa (201-350 pontos). Início de implementação básica de algumas práticas, de modo informal e pontual. A empresa reconhece a importância de melhorar, mas não há consistência."
                        };
                    case 3:
                        return {
                            level: 3,
                            title: "Desenvolvido",
                            description: "Maturidade intermediária (351-500 pontos). Processos e práticas já formalizados, porém aplicados de maneira parcial ou descoordenada. Os elementos de gestão não são uniformes."
                        };
                    case 4:
                        return {
                            level: 4,
                            title: "Gerenciado",
                            description: "Maturidade alta (501-650 pontos). Práticas de gestão bem estabelecidas e coordenadas, aplicadas de forma consistente. A gestão é efetiva e proativa na maior parte da empresa."
                        };
                    case 5:
                        return {
                            level: 5,
                            title: "Integrado",
                            description: "Maturidade muito alta (651-800 pontos). Excelência gerencial, com práticas integradas à cultura e melhoria contínua. A empresa é referência e possui desempenho superior e sustentado."
                        };
                    case 6:
                        return {
                            level: 6,
                            title: "Excelente",
                            description: "Maturidade excepcional (801-1000 pontos). Organização de classe mundial com práticas inovadoras, resultados excepcionais e reconhecimento como benchmark de mercado."
                        };
                    default:
                        return {
                            level: 1,
                            title: "Limitado",
                            description: "Maturidade muito baixa (0-200 pontos). Práticas de gestão inexistentes ou ad-hoc, resultados obtidos de forma não estruturada. A organização depende de esforços isolados."
                        };
                }
            }

            // Função para fallback mailto: do assessment
            function sendAssessmentEmailFallback(data) {
                const subject = encodeURIComponent('Resultado Assessment - Maturidade Organizacional');
                const body = encodeURIComponent(
                    `Dados do Assessment de Maturidade Organizacional\n\n` +
                    `Nome: ${data.userInfo.name}\n` +
                    `Email: ${data.userInfo.email}\n` +
                    `Empresa: ${data.userInfo.company}\n` +
                    `Cargo: ${data.userInfo.position}\n\n` +
                    `Resultado: ${data.result.level} - ${data.result.title}\n` +
                    `Pontuação: ${Math.round((Object.values(data.answers).reduce((sum, answer) => sum + answer.score, 0) / (Object.keys(data.answers).length * 5)) * 100)}%\n\n` +
                    `Descrição: ${data.result.description}\n\n` +
                    `Por favor, envie um relatório detalhado para este email.`
                );
                const mailtoLink = `mailto:contato@stratica.com.br?subject=${subject}&body=${body}`;
                window.open(mailtoLink, '_blank');
                
                // Mostrar mensagem de sucesso para o fallback
                const successDiv = document.createElement('div');
                successDiv.className = 'bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mt-4';
                successDiv.innerHTML = `
                    <p><strong>📧 Email Aberto!</strong> Seu cliente de email foi aberto com os dados do assessment.</p>
                    <p class="text-sm mt-2">Por favor, envie o email para receber seu relatório detalhado.</p>
                `;
                document.getElementById('resultado').appendChild(successDiv);
            }

            // Função para enviar os dados para o Supabase
            async function sendData(data) {
                console.log("--- DADOS PARA ENVIO ---");
                console.log(JSON.stringify(data, null, 2));

                try {
                    // Usar pontuação Stratica já calculada
                    const totalStraticaScore = data.totalStraticaScore;
                    const maxStraticaScore = 1000;
                    const calculatedPercentage = (totalStraticaScore / maxStraticaScore) * 100;
                    
                    // Gerar análise por dimensão para o email
                    const dimensionAnalysis = {};
                    for (const [dimension, dimensionData] of Object.entries(data.dimensionScores)) {
                        const percentage = Math.round((dimensionData.score / dimensionData.maxScore) * 100);
                        const dimensionPercentage = (dimensionData.score / dimensionData.maxScore) * 100;
                        const levelNumber = getDimensionLevel(dimensionPercentage);
                        const levelDetails = getResultDetailsForDimension(levelNumber);
                        
                        dimensionAnalysis[dimension] = {
                            score: dimensionData.score,
                            percentage: percentage,
                            level: {
                                level: levelNumber,
                                title: levelDetails.title,
                                description: levelDetails.description
                            }
                        };
                    }
                    
                    // Preparar dados para envio
                    const assessmentData = {
                        userInfo: data.userInfo,
                        result: data.result,
                        totalScore: totalStraticaScore,
                        percentage: Math.round(calculatedPercentage * 100) / 100, // Arredondar para 2 casas decimais
                        answers: data.answers,
                        dimensionAnalysis: dimensionAnalysis
                    };

                    // Tentar enviar dados para a Edge Function do Supabase
                    const response = await fetch('https://zfsdocnmxdaqvzuajbqp.supabase.co/functions/v1/assessment-results', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inpmc2RvY25teGRhcXZ6dWFqYnFwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU2MDE1MzIsImV4cCI6MjA3MTE3NzUzMn0.uVd_l00SE-icATJEKam9sWJwzMMbblyjAqaMebnIPtM'
                        },
                        body: JSON.stringify(assessmentData)
                    });

                    const result = await response.json();

                    if (response.ok && result.success) {
                        console.log("Assessment enviado com sucesso!");
                        // Mostrar mensagem de sucesso ao usuário
                        const successDiv = document.createElement('div');
                        successDiv.className = 'bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mt-4';
                        successDiv.innerHTML = `
                            <p><strong>✓ Sucesso!</strong> ${result.message}</p>
                            <p class="text-sm mt-2">Seu relatório detalhado foi enviado para o email cadastrado.</p>
                        `;
                        document.getElementById('resultado').appendChild(successDiv);
                    } else {
                        throw new Error(result.error || 'Erro na API');
                    }
                } catch (error) {
                    console.error('Erro ao enviar assessment:', error);
                    
                    // Verificar se é erro de rede (Edge Function não disponível)
                    if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError') || error.message.includes('fetch')) {
                        // Usar fallback mailto: automaticamente
                        console.log('Edge Function não disponível, usando fallback mailto:');
                        sendAssessmentEmailFallback(data);
                    } else {
                        // Outros erros - mostrar mensagem e oferecer fallback
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mt-4';
                        errorDiv.innerHTML = `
                            <p><strong>✗ Erro:</strong> ${error.message}</p>
                            <p class="text-sm mt-2">
                                <button onclick="sendAssessmentEmailFallback(${JSON.stringify(data).replace(/"/g, '&quot;')})" 
                                        class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-sm">
                                    📧 Enviar por Email
                                </button>
                            </p>
                        `;
                        document.getElementById('resultado').appendChild(errorDiv);
                    }
                }
            }

            // Inicialização
            renderQuiz();
            form.addEventListener('submit', calculateAndShowResult);
        });
    </script>

</body>
</html>
